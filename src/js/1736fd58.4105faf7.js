(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["1736fd58"],{"01b0":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"06ef":function(t,e,o){"use strict";var s=o("8c7e"),n=o("01b0"),i=o("742b");o("fe99")("search",1,(function(t,e,o,a){return[function(o){var s=t(this),n=void 0==o?void 0:o[e];return void 0!==n?n.call(o,s):new RegExp(o)[e](String(s))},function(t){var e=a(o,t,this);if(e.done)return e.value;var r=s(t),l=String(this),c=r.lastIndex;n(c,0)||(r.lastIndex=0);var u=i(r,l);return n(r.lastIndex,c)||(r.lastIndex=c),null===u?-1:u.index}]}))},"0ca6":function(t,e,o){},"11c0":function(t,e,o){"use strict";var s=o("0ca6"),n=o.n(s);n.a},"2df7":function(t,e,o){},"3bde":function(t,e,o){"use strict";var s=o("2df7"),n=o.n(s);n.a},"5ae1":function(t,e,o){"use strict";var s=o("f97c"),n=o.n(s);n.a},"5c47":function(t,e,o){"use strict";var s=o("8926"),n=o.n(s);n.a},"6e62":function(t,e,o){},"7c9f":function(t,e,o){"use strict";var s=o("a485"),n=o.n(s);n.a},8926:function(t,e,o){},"8b05":function(t,e,o){"use strict";var s=o("4778");e["a"]={getNames:function(t,e){s["a"].get("/students/names").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getDetails:function(t,e,o){s["a"].get("/students/details/"+o.id).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getTags:function(t,e){s["a"].get("/students/tags").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}}},a485:function(t,e,o){},b9eb:function(t,e,o){"use strict";var s=o("cb51"),n=o.n(s);n.a},cb51:function(t,e,o){},e1b0:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("toolbar-page",{attrs:{elements:t.elements,default:"home"}})},n=[],i=(o("c880"),o("288e"),o("08e9")),a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"row q-mb-md"},[o("q-input",{staticClass:"row full-width",attrs:{label:"Search",dark:""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),o("div",{staticClass:"row q-gutter-xs"},[o("div",{staticClass:"col bg-toolbar"},[o("q-bar",{staticClass:"bg-primary",attrs:{dense:""}},[o("div",{staticClass:"text-black"},[t._v("New")]),o("q-space"),t.newBookings.length>0?o("q-badge",{attrs:{color:"blue-9"}},[t._v("\n          "+t._s(t.newBookings.length)+"\n        ")]):t._e()],1),o("q-scroll-area",{staticStyle:{height:"80vh"},attrs:{visible:""}},[o("q-list",{staticClass:"no-padding"},t._l(t.newBookings,(function(e){return o("booking-card",{key:e.id,staticClass:"q-pa-xs text-white bg-grey-9 q-my-sm",attrs:{group:"new",dense:"",booking:e,stops:t.stops,routes:t.routes},on:{change:t.getBookings}})})),1)],1)],1),o("div",{staticClass:"col-3 bg-toolbar"},[o("q-bar",{staticClass:"bg-orange",attrs:{dense:""}},[o("div",[t._v("Pending")]),o("q-space"),t.pendingBookings.length>0?o("q-badge",{attrs:{color:"orange-9"}},[t._v("\n          "+t._s(t.pendingBookings.length)+"\n        ")]):t._e(),o("q-btn",{attrs:{dense:"",flat:"",icon:"fal fa-envelope"}})],1),o("q-scroll-area",{staticStyle:{height:"80vh"},attrs:{visible:""}},[o("q-list",{staticClass:"no-padding"},t._l(t.pendingBookings,(function(e){return o("booking-card",{key:e.id,staticClass:"q-pa-xs text-white bg-grey-9 q-my-sm",attrs:{group:"pending",dense:"",booking:e,stops:t.stops,routes:t.routes},on:{change:t.getBookings}})})),1)],1)],1),o("div",{staticClass:"col-3 bg-toolbar"},[o("q-bar",{staticClass:"bg-light-green-5",attrs:{dense:""}},[o("div",[t._v("Confirmed To Parents")]),o("q-space")],1),o("q-scroll-area",{staticStyle:{height:"80vh"},attrs:{visible:""}},[o("q-list",{staticClass:"no-padding"},t._l(t.confirmedBookings,(function(e){return o("booking-card",{key:e.id,staticClass:"q-pa-xs text-white bg-grey-9 q-my-sm",attrs:{group:"confirmed",dense:"",booking:e,stops:t.stops,routes:t.routes},on:{change:t.getBookings}})})),1)],1)],1),o("div",{staticClass:"col-2 bg-toolbar row"},[o("div",{staticClass:"full-width column wrap justify-start items-start content-start"},[o("div",{staticStyle:{overflow:"auto","min-width":"100%","max-width":"100%"}},[o("q-bar",{staticClass:"bg-red-14",attrs:{dense:""}},[o("div",[t._v("Cancelled")]),o("q-space")],1),o("q-scroll-area",{staticStyle:{height:"40vh"},attrs:{visible:""}},[o("q-list",{staticClass:"no-padding"},t._l(t.cancelledBookings,(function(e){return o("booking-card",{key:e.id,staticClass:"q-pa-xs text-white bg-grey-9 q-my-sm",attrs:{group:"cancelled",dense:"",booking:e,stops:t.stops,routes:t.routes}})})),1)],1)],1),t.declinedBookings.length>0?o("div",{staticStyle:{overflow:"auto","min-width":"100%","max-width":"100%"}},[o("q-bar",{staticClass:"bg-blue-14 text-white",attrs:{dense:""}},[o("div",[t._v("Declined")]),o("q-space")],1),o("q-scroll-area",{staticStyle:{height:"40vh"},attrs:{visible:""}},[o("q-list",{staticClass:"no-padding"},t._l(t.declinedBookings,(function(e){return o("booking-card",{key:e.id,staticClass:"q-pa-xs text-white bg-grey-9 q-my-sm",attrs:{group:"declined",dense:"",booking:e,stops:t.stops,routes:t.routes}})})),1)],1)],1):t._e()])])])])},r=[],l=(o("06ef"),o("4778")),c=o("452d"),u={putBooking:function(t,e,o){l["a"].put("/transport/coaches/bookings",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},postBooking:function(t,e,o){l["a"].post("/transport/coaches/bookings",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},deleteBooking:function(t,e,o){l["a"].delete("/transport/coaches/bookings/"+o).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},declineBooking:function(t,e,o){l["a"].delete("/transport/coaches/bookings/decline/"+o).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getAllBookings:function(t,e,o){var s=c["a"].getters["transport/activeSession"];l["a"].get("/transport/coaches/bookings/"+s).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getNewCount:function(t,e){var o=c["a"].getters["transport/activeSession"];l["a"].get("/transport/coaches/newbookings/"+o).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},putCoachAssignment:function(t,e,o){l["a"].put("/transport/coaches/assignment",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},putConfirmBooking:function(t,e,o){l["a"].put("/transport/coaches/confirm",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))}},d=o("5228"),p=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"col",staticStyle:{"min-width":"500px","min-height":"50vh"}},[o("div",{staticClass:"col-12"},[o("q-select",{ref:"name",attrs:{"map-options":"",dense:"",autofocus:"",clearable:"",outlined:"",options:t.pupilOptions,label:"Pupil Name","content-class":"bg-dark",dark:"","use-input":"","input-debounce":"0",readonly:t.isEdit},on:{change:function(e){return t.pupilDetails(t.selectedPupil)},input:function(e){return t.pupilDetails(t.selectedPupil)},filter:t.pupilFilter},model:{value:t.selectedPupil,callback:function(e){t.selectedPupil=e},expression:"selectedPupil"}}),t.pupilHouse?o("q-chip",{attrs:{dense:"",icon:"home",size:"10px"}},[t._v(t._s(t.pupilHouse))]):t._e(),t.pupilEmail?o("q-chip",{attrs:{dense:"",icon:"mail",size:"10px"}},[t._v(t._s(t.pupilEmail))]):t._e()],1),o("br"),o("q-tabs",{staticClass:"bg-grey-8 text-primary",attrs:{dense:""},model:{value:t.journeyTab,callback:function(e){t.journeyTab=e},expression:"journeyTab"}},[t.isRetOnly?t._e():o("q-tab",{attrs:{name:"out",label:"Outbound"}}),t.isOutOnly?t._e():o("q-tab",{attrs:{name:"ret",label:"Return"}})],1),o("q-tab-panels",{attrs:{animated:""},model:{value:t.journeyTab,callback:function(e){t.journeyTab=e},expression:"journeyTab"}},[o("q-tab-panel",{staticClass:"bg-secondar q-px-xs",attrs:{name:"out"}},[o("h1",{staticClass:"q-mx-none q-pa-xs fullwidth bgx-grey-8"},[t._v("Destination")]),o("q-select",{ref:"stopOut",attrs:{"map-options":"",outlined:"",dense:"",clearable:"",options:t.stopsOutOptions,label:"To","content-class":"bg-dark",dark:"","use-input":"","emit-value":"","input-debounce":"0"},on:{filter:t.stopOutFilter},model:{value:t.booking.out.stopId,callback:function(e){t.$set(t.booking.out,"stopId",e)},expression:"booking.out.stopId"}}),t.stopOutInfo?o("div",[o("p",[t._v(t._s(t.stopOutInfo.cost))])]):t._e()],1),o("q-tab-panel",{staticClass:"bg-secondar q-px-xs",attrs:{name:"ret"}},[o("h1",{staticClass:"q-mx-none q-pa-xs fullwidth bgx-grey-8"},[t._v("From")]),o("q-select",{ref:"stopRet",attrs:{"map-options":"",outlined:"",dense:"",clearable:"",options:t.stopsRetOptions,label:"From","content-class":"bg-dark",dark:"","use-input":"","emit-value":"","input-debounce":"0"},on:{filter:t.stopRetFilter},model:{value:t.booking.ret.stopId,callback:function(e){t.$set(t.booking.ret,"stopId",e)},expression:"booking.ret.stopId"}})],1)],1),o("div",[o("div",{staticClass:"row q-mt-md full-width"},[o("q-btn",{staticClass:"text-primary col",attrs:{disabled:!t.showBottomButtons,size:"large",outlinex:"",xflat:"",color:"primary","text-color":"black",dark:"",icon:"fal fa-check",label:t.isEdit?"Save Changes":"Submit Booking"},nativeOn:{click:function(e){return t.submit(e)}}})],1)])],1)},g=[],f=(o("ce9c"),o("8b05")),b={name:"TBSCoachBookingNew",props:{bookingToEdit:{type:Object},id:{type:Number},channel:{type:String,default:""}},data:function(){return{dark:!0,isEdit:!1,isOutOnly:!1,isRetOnly:!1,hasSubmitted:!1,pupilNames:[],pupilOptions:[],journeyTab:"out",selectedPupil:null,pupilHouse:null,pupilEmail:null,stopsOutOptions:[],stopsRetOptions:[],stops:{out:[],ret:[]},booking:{id:null,pupilId:null,sessionId:null,out:{stopId:null},ret:{stopId:null}}}},methods:{submit:function(){var t=this;this.showBottomButtons&&(this.hasSubmitted=!0,this.$q.loading.show(),this.isEdit?u.putBooking((function(){t.$q.notify("Submitted"),t.$q.loading.hide(),t.$emit("saved")}),(function(){t.$q.notify("Sad Face :("),t.$q.loading.hide()}),this.booking):u.postBooking((function(){t.$q.notify("Submitted"),t.$q.loading.hide(),t.$emit("saved")}),(function(){t.$q.notify("Sad Face :("),t.$q.loading.hide()}),this.booking))},pupilDetails:function(t){var e=this;this.booking.pupilId=t.value,f["a"].getDetails((function(t){e.pupilHouse=t.boardingHouse,e.pupilEmail=t.email}),null,{id:t.value})},getStudents:function(){var t=this;f["a"].getNames((function(e){if(t.pupilNames=e.map((function(t){return{value:t.id,label:t.lastname+", "+t.firstname,sublabel:"Millmead"}})),t.bookingToEdit){var o=t.pupilNames.find((function(e){return e.value===t.bookingToEdit.studentId}));t.selectedPupil=t.bookingToEdit?o:null,t.pupilDetails(o)}}))},stopOutFilter:function(t,e){var o=this;e(""!==t?function(){var e=t.toLowerCase();o.stopsOutOptions=o.stopsOut.filter((function(t){return t.label.toLowerCase().indexOf(e)>-1}))}:function(){o.stopsOutOptions=o.stopsOut})},stopRetFilter:function(t,e){var o=this;e(""!==t?function(){var e=t.toLowerCase();o.stopsRetOptions=o.stopsRet.filter((function(t){return t.label.toLowerCase().indexOf(e)>-1}))}:function(){o.stopsRetOptions=o.stopsRet})},pupilFilter:function(t,e){var o=this;e(""!==t?function(){var e=t.toLowerCase();o.pupilOptions=o.pupilNames.filter((function(t){return t.label.toLowerCase().indexOf(e)>-1}))}:function(){o.pupilOptions=o.pupilNames})},pickupFilter:function(t,e){var o=this;e(""!==t?function(){var e=t.toLowerCase();o.pickupOptions=o.pickupOptions.filter((function(t){return t.label.toLowerCase().indexOf(e)>-1}))}:function(){o.pickupOptions=o.pickupLocations})},mergeJourney:function(t,e){t.stopId=e.stopId},getStops:function(){var t=this;d["a"].getStops((function(e){t.stops=e}),null,this.booking.sessionId)}},computed:{stopOutInfo:function(){var t=this,e=this.stops.out.find((function(e){return e.id===t.booking.out.stopId}));return e},stopRetInfo:function(){var t=this;return this.stops.ret.find((function(e){return e.id===t.booking.ret.stopId}))},showBottomButtons:function(){return!!this.selectedPupil&&(this.isEdit||this.booking.out.stopId||this.booking.ret.stopId)},stopsOut:function(){return 0===this.stops.length?[]:this.stops.out.map((function(t){return{value:t.id,label:t.name}}))},stopsRet:function(){return 0===this.stops.length?[]:this.stops.ret.map((function(t){return{value:t.id,label:t.name}}))}},watch:{},components:{},created:function(){if(this.bookingToEdit){var t=this.bookingToEdit;this.isEdit=!0,this.booking.sessionId=t.sessionId,this.booking.id=t.id,t.isReturn?(this.isRetOnly=!0,this.mergeJourney(this.booking.ret,t),this.journeyTab="ret"):(this.isOutOnly=!0,this.mergeJourney(this.booking.out,t))}this.getStudents(),this.booking.sessionId=this.$store.getters["transport/activeSession"],this.getStops()}},h=b,m=(o("3bde"),o("2be6")),v=Object(m["a"])(h,p,g,!1,null,"47311d07",null),k=v.exports,q=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"q-pa-xs q-my-sm"},[o("q-expansion-item",{staticClass:"text-white bg-grey-9",attrs:{group:t.group,dense:""},scopedSlots:t._u([{key:"header",fn:function(){return[1===t.status?o("q-item-section",{staticClass:"flex",attrs:{avatar:""}},[0===t.booking.isReturn?o("q-icon",{attrs:{color:"white",name:"fal fa-arrow-square-right"}}):t._e(),1===t.booking.isReturn?o("q-icon",{attrs:{name:"fal fa-arrow-square-left",color:"primary"}}):t._e()],1):t._e(),1===t.status?o("q-item-section",[o("q-item-label",[o("div",{staticClass:"row fullwidth"},[t._v("\n            "+t._s(t.booking.displayName)+"\n            "),0===t.booking.isReturn?o("q-icon",{staticClass:"q-mx-md",attrs:{name:"fal fa-arrow-right"}}):t._e(),1===t.booking.isReturn?o("q-icon",{staticClass:"q-mx-md",attrs:{name:"fal fa-arrow-left"}}):t._e(),t._v("\n            "+t._s(t.booking.stop)+"\n          ")],1)])],1):t._e(),t.status>1?o("q-item-section",[o("q-item-label",[o("div",{staticClass:"row fullwidth"},[t._v("\n            "+t._s(t.booking.displayName)+"\n          ")])]),t.booking.statusId>1?o("q-item-label",{staticClass:"text-white",attrs:{caption:""}},[o("div",{staticClass:"row"},[t._v("\n            "+t._s(t.booking.stop)+"\n            "),0===t.booking.isReturn?o("q-icon",{staticClass:"q-mx-md",attrs:{name:"fal fa-arrow-right"}}):t._e(),1===t.booking.isReturn?o("q-icon",{staticClass:"q-mx-md",attrs:{name:"fal fa-arrow-left"}}):t._e(),t._v("\n            "+t._s(t.booking.coachCode)+"\n            "),t.booking.statusId<4?o("select-button",{staticClass:"q-ml-sm",staticStyle:{"max-width":"20px"},attrs:{size:"xs",icon:"fal fa-bus",title:t.booking.stop,success:t.saveCoach,model:t.booking,field:"coachId",options:t.availiableCoaches,fieldLabel:"Select Coach",color:"lime-13","text-color":"black"}}):t._e()],1)]):t._e()],1):t._e()]},proxy:!0}])},[o("q-item-section",{staticClass:"bg-grey-9 booking-details"},[o("q-item-label",{staticClass:"q-ml-md q-mt-md"},[o("q-badge",{staticClass:"q-mr-xs label",attrs:{color:"grey-7","text-color":"white",label:"Ref"}}),t._v("\n        "+t._s(t.booking.id)+"\n      ")],1),o("q-item-label",{staticClass:"q-ml-md q-mt-md"},[o("q-badge",{staticClass:"q-mr-xs label",attrs:{color:"grey-7","text-color":"white",label:"Route"}}),t._v("\n        "+t._s(t.route.name)+"\n      ")],1),o("q-item-label",{staticClass:"q-ml-md q-mt-md"},[o("q-badge",{staticClass:"q-mr-xs label",attrs:{color:"grey-7","text-color":"white",label:"Stop"}}),t._v("\n        "+t._s(t.stop.name)+"\n      ")],1),t.status>1?o("q-item-label",{staticClass:"q-ml-md q-mt-md"},[o("q-badge",{staticClass:"q-mr-xs label",attrs:{color:0===t.booking.cost?"red":"grey-7","text-color":"white"}},[t._v("\n        Price\n        "),0===t.booking.cost?o("q-icon",{staticClass:"q-ml-xs",attrs:{name:"warning",size:"14px"}}):t._e()],1),t._v("\n        Â£"+t._s(t.booking.cost)+"\n      ")],1):t._e(),t.status>1?o("q-item-label",{staticClass:"q-ml-md q-mt-md"},[o("q-badge",{staticClass:"q-mr-xs  label",attrs:{color:"grey-4","text-color":"black",label:"Coach"}}),t._v("\n        "+t._s(t.booking.coachCode)+"\n        "),o("select-button",{staticClass:"q-ml-sm",attrs:{size:"sm",icon:"fal fa-bus",title:t.booking.stop,success:t.saveCoach,model:t.booking,field:"coachId",options:t.availiableCoaches,fieldLabel:"Select Coach",color:"lime-13","text-color":"black"}})],1):t._e(),o("q-item-label",{staticClass:"q-mt-sm"},[o("q-bar",{staticClass:"q-mt-md bg-grey-9 row",attrs:{dense:""}},[o("confirm-button",{attrs:{label:"can",color:"deep-orange-13",title:"Cancel Booking?",success:t.cancelBooking,"text-color":"black",icon:"fal fa-minus"}}),o("confirm-button",{attrs:{label:"decline",color:"blue-4",title:"Decline Booking?",success:t.declineBooking,"text-color":"black",icon:"fal fa-heart-broken"}}),o("q-btn",{staticClass:"col",attrs:{dense:"",left:"",icon:"fal fa-edit",color:"grey-4","text-color":"black",label:"edit",size:"xs"},on:{click:function(e){return t.editBooking()}}}),1===t.status?o("select-button",{staticClass:"q-ml-sm",attrs:{size:"xs",icon:"fal fa-bus",title:t.booking.stop,success:t.saveCoach,model:t.booking,field:"coachId",options:t.availiableCoaches,fieldLabel:"Select Coach",color:"lime-13","text-color":"black",label:"assign"}}):t._e(),2===t.status||3===t.status?o("q-btn",{staticClass:"col",attrs:{disabled:!t.booking.cost>0,dense:"",icon:"fal fa-envelope",color:"lime-13","text-color":"black",size:"xs",label:"confirm"}},[0===t.booking.cost?o("q-tooltip",{attrs:{"content-class":"bg-lime-13 text-black",offset:[10,10]}},[t._v("\n              Set the price to confirm!\n            ")]):t._e(),t.booking.cost>0?o("q-popup-proxy",[o("q-card",{staticClass:"bg-blue-grey-7",attrs:{dark:""}},[o("q-card-section",[o("div",[t._v("Send Confirmation Email(s)?")])]),o("q-separator",{attrs:{dark:"",inset:""}}),o("q-card-section",{},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"full-width",attrs:{color:"pink",label:"Confirm"},on:{click:function(e){return t.confirmBooking()}}})],1)],1)],1):t._e()],1):t._e()],1)],1)],1)],1),o("q-dialog",{ref:"new",attrs:{"content-classes":"new-modal bg-dark q-pa-md",persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.showEditForm,callback:function(e){t.showEditForm=e},expression:"showEditForm"}},[o("q-card",{staticClass:"bg-grey-9",attrs:{dark:""}},[o("q-toolbar",[o("q-toolbar-title",[t._v("Edit Booking "+t._s(t.booking.id))]),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),o("q-card-section",[o("booking",{key:t.booking.id,attrs:{id:t.booking.id,bookingToEdit:t.booking,channel:"tbs.coaches.bookings"},on:{close:function(e){t.showEditForm=!1},saved:t.emit}})],1)],1)],1)],1)},C=[],x=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-btn",{staticClass:"col",attrs:{size:t.size,icon:t.icon,outline:t.outline,dense:"","text-color":t.textColor,color:t.color,label:t.label},on:{click:function(t){t.stopPropagation()}}},[t.tooltip?o("q-tooltip",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[t._v("\n     "+t._s(t.tooltip)+"\n   ")]):t._e(),o("q-popup-proxy",{ref:"popup",attrs:{persistent:""}},[o("q-card",{staticClass:"bg-blue-grey-9",attrs:{dark:""}},[o("q-card-section",[t._v("\n        "+t._s(t.title)+"\n      ")]),o("q-separator",{attrs:{dark:"",inset:""}}),o("q-card-section",{},[o("q-select",{attrs:{"emit-value":"","map-options":"",dark:"",filled:"",options:t.options,fieldLabel:t.label},model:{value:t.model[t.field],callback:function(e){t.$set(t.model,t.field,e)},expression:"model[field]"}}),o("br"),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"full-width",attrs:{"text-color":"black",color:"lime-13",disabled:!t.model[t.field],label:t.buttonLabel},on:{click:function(e){return t.success(t.model)}}})],1)],1)],1)],1)},w=[],y={name:"Component.Buttons.New",props:{success:{type:Function,required:!0},model:{type:Object,required:!0},options:{type:Array,required:!0},field:{type:String,required:!0},size:{type:String,default:"xs"},icon:{type:String,default:"fal fa-edit"},title:{type:String,default:""},fieldLabel:{type:String,default:""},type:{type:String,default:""},tooltip:{type:String},color:{type:String,default:"primary"},label:{type:String,default:""},buttonLabel:{type:String,default:"Save"},textColor:{type:String,default:""},outline:{type:Boolean}},data:function(){return{}},methods:{},computed:{},components:{},created:function(){}},_=y,S=(o("b9eb"),Object(m["a"])(_,x,w,!1,null,"6c0ca435",null)),B=S.exports,O=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-btn",{staticClass:"col",attrs:{size:t.size,icon:t.icon,color:t.color,outline:t.outline,dense:"","text-color":t.textColor,label:t.label},on:{click:function(t){t.stopPropagation()}}},[t.tooltip?o("q-tooltip",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[t._v("\n     "+t._s(t.tooltip)+"\n   ")]):t._e(),o("q-popup-proxy",[o("q-card",{staticClass:"bg-blue-grey-9",staticStyle:{width:"200px"},attrs:{dark:""}},[o("q-card-section",[t._v("\n        "+t._s(t.title)+"\n      ")]),o("q-separator",{attrs:{dark:"",inset:""}}),o("q-card-section",{staticClass:"row q-gutter-sm"},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"col",attrs:{color:"pink",label:t.buttonLabelNo}}),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"col",attrs:{color:"lime-13","text-color":"black",label:t.buttonLabelYes},on:{click:function(e){return t.success(t.model)}}})],1)],1)],1)],1)},I=[],E={name:"Component.Buttons.New",props:{success:{type:Function,required:!0},model:{type:Object,default:function(){}},size:{type:String,default:"xs"},icon:{type:String,default:"fal fa-edit"},title:{type:String,default:""},fieldLabel:{type:String,default:""},type:{type:String,default:""},tooltip:{type:String},color:{type:String,default:"primary"},label:{type:String,default:""},buttonLabelYes:{type:String,default:"Yes"},buttonLabelNo:{type:String,default:"No"},textColor:{type:String,default:""},outline:{type:Boolean}},data:function(){return{}},methods:{},computed:{},components:{},created:function(){}},N=E,R=(o("fc24"),Object(m["a"])(N,O,I,!1,null,"f1806260",null)),D=R.exports,$={name:"CoachBookingCard",props:{booking:{type:Object,required:!0},stops:{type:Object,required:!0},routes:{type:Array,required:!0},group:{type:String,required:!0}},data:function(){return{showEditForm:!1,bookingId:null,currentBooking:null}},methods:{saveCoach:function(){u.putCoachAssignment(this.emit,null,this.booking)},confirmBooking:function(){u.putConfirmBooking(this.emit,null,this.booking)},cancelBooking:function(){u.deleteBooking(this.emit,null,this.booking.id)},declineBooking:function(){u.declineBooking(this.emit,null,this.booking.id)},editBooking:function(){this.currentBookingId=this.booking.id,this.showEditForm=!0,this.currentBooking=this.booking},emit:function(){this.showEditForm=!1,this.$emit("change")}},computed:{status:function(){return this.booking.statusId},taxiCompanyName:function(){var t=this.booking.taxiId,e=this.taxiCompanies.find((function(e){return e.value===t}));return e?e.label:"ERROR"},route:function(){var t=this.booking.routeId,e=this.routes.find((function(e){return e.id===t}));return e||"ERROR"},stop:function(){var t=this.booking.stopId,e=1===this.booking.isReturn?this.stops.ret:this.stops.out,o=e.find((function(e){return e.id===t}));return o?(console.warn(o),o):"ERROR"},availiableCoaches:function(){return this.stop.coaches.map((function(t){return{value:t.id,label:t.code+" ["+t.spacesLeft+" spaces]"}}))}},components:{Booking:k,SelectButton:B,ConfirmButton:D},created:function(){console.log("bk",this.booking),console.log("stops",this.stops),console.log("routes",this.routes)}},L=$,j=(o("5ae1"),Object(m["a"])(L,q,C,!1,null,"7e73059c",null)),F=j.exports,T={name:"Coaches.Home",props:{},data:function(){return{rawBookings:[],stops:[],routes:[],search:"",showEditForm:!1,currentBookingId:null,currentBooking:null,session:null}},methods:{getBookings:function(){var t=this;this.getStops(),this.getRoutes(),u.getAllBookings((function(e){t.rawBookings=e}),null)},getStops:function(){var t=this;d["a"].getStops((function(e){t.stops=e}),this.$error,this.session)},getRoutes:function(){var t=this;d["a"].getRoutes((function(e){t.routes=e}),this.$error,this.session)},initialise:function(){var t=this.$store.getters["transport/activeSession"];this.session=t,this.$wampSubscribe("coaches"+t,this.getBookings),this.getBookings()}},computed:{bookings:function(){var t=this.search;return""===t?this.rawBookings:this.rawBookings.filter((function(e){return e.displayFrom.toLowerCase().indexOf(t)>-1||e.displayTo.toLowerCase().indexOf(t)>-1||e.displayName.toLowerCase().indexOf(t)>-1}))},newBookings:function(){return this.bookings.filter((function(t){return 1===t.statusId}))},pendingBookings:function(){return this.bookings.filter((function(t){return 2===t.statusId}))},confirmedBookings:function(){return this.bookings.filter((function(t){return 3===t.statusId}))},cancelledBookings:function(){return this.bookings.filter((function(t){return 4===t.statusId}))},declinedBookings:function(){return this.bookings.filter((function(t){return 5===t.statusId}))}},components:{Booking:k,BookingCard:F},created:function(){var t=this;this.$store.watch((function(){return t.$store.getters["transport/activeSession"]}),this.getBookings),this.initialise()}},z=T,P=(o("11c0"),Object(m["a"])(z,a,r,!1,null,"0b25d114",null)),H=P.exports,A=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"row no-wrap justify-around q-px-md q-pt-md"},[o("div",{directives:[{name:"mutation",rawName:"v-mutation",value:t.handler1,expression:"handler1"}],staticClass:"drop-target rounded-borders overflow-hidden",on:{dragenter:t.onDragEnter,dragleave:t.onDragLeave,dragover:t.onDragOver,drop:t.onDrop}},[o("div",{staticClass:"box navy",attrs:{id:"box1",draggable:"true"},on:{dragstart:t.onDragStart}}),o("div",{staticClass:"box red",attrs:{id:"box2",draggable:"true"},on:{dragstart:t.onDragStart}}),o("div",{staticClass:"box green",attrs:{id:"box3",draggable:"true"},on:{dragstart:t.onDragStart}}),o("div",{staticClass:"box orange",attrs:{id:"box4",draggable:"true"},on:{dragstart:t.onDragStart}}),o("div",{staticClass:"box navy",attrs:{id:"box5",draggable:"true"},on:{dragstart:t.onDragStart}}),o("div",{staticClass:"box red",attrs:{id:"box6",draggable:"true"},on:{dragstart:t.onDragStart}}),o("div",{staticClass:"box green",attrs:{id:"box7",draggable:"true"},on:{dragstart:t.onDragStart}}),o("div",{staticClass:"box orange",attrs:{id:"box8",draggable:"true"},on:{dragstart:t.onDragStart}})]),o("div",{directives:[{name:"mutation",rawName:"v-mutation",value:t.handler2,expression:"handler2"}],staticClass:"drop-target rounded-borders overflow-hidden",on:{dragenter:t.onDragEnter,dragleave:t.onDragLeave,dragover:t.onDragOver,drop:t.onDrop}})]),o("div",{staticClass:"row justify-around items-start"},[o("div",{staticClass:"col row justify-center q-pa-md"},[o("div",{staticClass:"text-subtitle1"},[t._v("\n        Mutation Info\n      ")]),t._l(t.status1,(function(e){return o("div",{key:e},[t._v("\n        "+t._s(e)+"\n      ")])}))],2),o("div",{staticClass:"col row justify-center q-pa-md"},[o("div",{staticClass:"text-subtitle1"},[t._v("\n        Mutation Info\n      ")]),t._l(t.status2,(function(e){return o("div",{key:e},[t._v("\n        "+t._s(e)+"\n      ")])}))],2)])])},J=[],V={data:function(){return{status1:[],status2:[]}},methods:{handler1:function(t){for(var e in this.status1=[],t){var o=t[e],s="type: ".concat(o.type,", nodes added: ").concat(o.addedNodes.length>0?"true":"false",", nodes removed: ").concat(o.removedNodes.length>0?"true":"false",", oldValue: ").concat(o.oldValue);this.status1.push(s)}},handler2:function(t){for(var e in this.status2=[],t){var o=t[e],s="type: ".concat(o.type,", nodes added: ").concat(o.addedNodes.length>0?"true":"false",", nodes removed: ").concat(o.removedNodes.length>0?"true":"false",", oldValue: ").concat(o.oldValue);this.status2.push(s),console.warn(o)}},onDragStart:function(t){t.dataTransfer.setData("text",t.target.id),t.dataTransfer.dropEffect="move"},onDragEnter:function(t){!0!==t.target.draggable&&t.target.classList.add("drag-enter")},onDragLeave:function(t){t.target.classList.remove("drag-enter")},onDragOver:function(t){t.preventDefault()},onDrop:function(t){if(t.preventDefault(),!0!==t.target.draggable){var e=t.dataTransfer.getData("text"),o=document.getElementById(e);o.parentNode!==t.target?(o.parentNode.removeChild(o),t.target.appendChild(o),t.target.classList.remove("drag-enter")):t.target.classList.remove("drag-enter")}}}},M=V,Y=(o("7c9f"),Object(m["a"])(M,A,J,!1,null,"53de957a",null)),G=Y.exports,K=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"full-width",attrs:{stylex:"text-align:center; position: relative"}},[o("q-dialog",{ref:"new",attrs:{"content-classes":"new-modal bg-dark q-pa-md",persistent:"","transition-show":"scale","transition-hide":"scale"},on:{hide:t.close},model:{value:t.showForm,callback:function(e){t.showForm=e},expression:"showForm"}},[o("q-card",{staticClass:"bg-grey-9",attrs:{dark:""}},[o("q-toolbar",[o("q-icon",{attrs:{name:"fal fa-bus",size:"sm",color:""}}),o("q-toolbar-title",[t._v("New Booking")]),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),o("q-card-section",[o("booking",{attrs:{channel:"tbs.coach.bookings"},on:{close:t.close,saved:t.close}})],1)],1)],1)],1)},Q=[],U={name:"CoachBookingNewContainer",props:{},data:function(){return{showForm:!0}},methods:{close:function(){this.showEditForm=!1,this.$emit("close")}},computed:{},components:{Booking:k},created:function(){}},W=U,X=(o("5c47"),Object(m["a"])(W,K,Q,!1,null,"ba89c440",null)),Z=X.exports,tt=o("423b"),et={name:"PageTransportCoaches",data:function(){return{elements:[{name:"home",component:H,icon:"fal fa-home",shortcut:"b",count:0,tooltip:"Home"},{name:"coaches",labelx:"coaches",component:G,icon:"fal fa-poll-people",shortcut:"c",tooltip:"Set Coaches"},{name:"new",labelx:"Overview",component:Z,icon:"fal fa-plus",shortcut:"c",tooltip:"New Booking"},{name:"routes",labelx:"routes",icon:"fal fa-route",component:tt["a"],shortcut:"s",tooltip:"Route Settings"}]}},components:{toolbarPage:i["a"]},methods:{newCount:function(){var t=this;u.getNewCount((function(e){var o=t.elements.find((function(t){return"home"===t.name}));o.count=e}),null)},counts:function(){this.$wampSubscribe("coaches"+this.activeSession,this.newCount),this.newCount()}},created:function(){var t=this;this.counts(),this.$store.watch((function(){return t.$store.getters["transport/activeSession"]}),this.counts)}},ot=et,st=Object(m["a"])(ot,s,n,!1,null,null,null);e["default"]=st.exports},f97c:function(t,e,o){},fc24:function(t,e,o){"use strict";var s=o("6e62"),n=o.n(s);n.a}}]);