(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[32],{"854d":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("toolbar-page",{attrs:{elements:t.elements}})},n=[],r=a("08e9"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row fit"},[a("div",{staticClass:"flex-center q-mr-md"},[a("q-btn",{staticClass:"q-mt-md q-mx-sm",staticStyle:{width:"50px",height:"30px"},attrs:{roundx:"",color:"tertiary",size:"sm","text-color":"font",icon:"fal fa-retweet-alt"},on:{click:t.getAttendance}}),a("confirm-button",{staticClass:"q-mt-md q-ml-sm q-py-xs",staticStyle:{width:"100px",height:"30px"},attrs:{color:"accent",title:"Send Emails?",success:t.sendHouseEmails,"text-color":"dark",icon:"fal fa-paper-plane",size:"sm"}})],1),a("div",{staticClass:"col-4 q-mr-lg"},[a("q-input",{staticStyle:{border:"1px solid font"},attrs:{filled:"",maskx:"DD-MM-YYYY"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{options:t.dateOptions,minimal:"",mask:"DD-MM-YYYY","first-day-of-week":"1"},on:{input:function(){return t.$refs.qDateProxy.hide()}},model:{value:t.dateString,callback:function(e){t.dateString=e},expression:"dateString"}})],1)],1)]},proxy:!0}]),model:{value:t.dateString,callback:function(e){t.dateString=e},expression:"dateString"}})],1),a("div",{staticClass:"col"},[a("q-card",{staticClass:"q-mt-md bg-tertiary"},[a("q-tabs",{staticClass:"text-font bg-tertiary",attrs:{dense:"","active-color":"accent","indicator-color":"accent",align:"justify","narrow-indicator":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab",{attrs:{name:"summary",label:"Summary"}}),a("q-tab",{attrs:{name:"houses",label:"Houses"}}),a("q-tab",{attrs:{name:"privs",label:"Privs"}})],1)],1)],1)]),a("div",{staticClass:"row fit"},[a("q-tab-panels",{staticClass:"fit ",attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"summary"}},[a("crud",{ref:"crud",staticStyle:{max:"height:80vh"},attrs:{dataOverride:t.housesSummary,columns:t.houseSummaryColumns,sortBy:"id"}})],1),a("q-tab-panel",{staticClass:"col",attrs:{name:"houses"}},[a("div",{staticClass:"row fit full-width bg-toolbar"},[a("q-select",{staticClass:"no-margin text-secondary q-my-sm",staticStyle:{"min-width":"250px","max-width":"500px","border-radius":"5px"},attrs:{outlined:"",options:t.houses,dense:"","options-dense":"","options-dark":"","emit-value":"",dark:"",inverted:"",placeholder:"House",filter:"","filter-placeholder":"search"},model:{value:t.house,callback:function(e){t.house=e},expression:"house"}}),a("q-tabs",{staticClass:"text-grey",attrs:{dense:"",dark:"","active-color":"accent","indicator-color":"accent",align:"justify","narrow-indicator":""},model:{value:t.housetab,callback:function(e){t.housetab=e},expression:"housetab"}},[a("q-tab",{attrs:{name:"missed",label:"Missed"}},[t.data?a("q-badge",{attrs:{color:"red",floating:""}},[t._v(t._s(t.currentHouse.missed.length))]):t._e()],1),a("q-tab",{attrs:{name:"attended",label:"Attended"}},[t.data?a("q-badge",{attrs:{color:"accent",floating:""}},[t._v(t._s(t.currentHouse.attended.length))]):t._e()],1),a("q-tab",{attrs:{name:"priv",label:"Privs"}},[t.data?a("q-badge",{attrs:{color:"accent",floating:""}},[t._v(t._s(t.currentHouse.priv.length))]):t._e()],1),a("q-tab",{attrs:{name:"history",label:"history",disabled:""}})],1)],1),a("div",{staticClass:"row"},[a("q-tab-panels",{staticClass:"fit",attrs:{animated:""},model:{value:t.housetab,callback:function(e){t.housetab=e},expression:"housetab"}},[a("q-tab-panel",{attrs:{name:"missed"}},[a("crud",{ref:"crud",staticStyle:{max:"height:80vh"},attrs:{dataOverride:t.currentHouse.missed,columns:t.missedColumns,sortBy:"name",search:"",rowsPerPage:"1000"}})],1),a("q-tab-panel",{attrs:{name:"attended"}},[a("crud",{ref:"crud",staticStyle:{max:"height:80vh"},attrs:{dataOverride:t.currentHouse.attended,columns:t.attendedColumns,sortBy:"name",search:"",rowsPerPage:"1000"}})],1),a("q-tab-panel",{attrs:{name:"priv"}},[a("crud",{ref:"crud",staticStyle:{max:"height:80vh"},attrs:{dataOverride:t.currentHouse.priv,columns:t.attendedColumns,sortBy:"name",search:"",rowsPerPage:"1000"}})],1),a("q-tab-panel",{attrs:{name:"history"}})],1)],1)])],1)],1),a("q-dialog",{attrs:{"content-class":"bg-dark"},model:{value:t.emailPanel,callback:function(e){t.emailPanel=e},expression:"emailPanel"}},[a("q-card",{staticClass:"bg-grey-2"},[a("q-toolbar",[a("q-avatar",[a("q-icon",{attrs:{name:"fal fa-eye"}})],1),a("q-toolbar-title",[a("span",{staticClass:"text-weight-bold"},[t._v("Chapel")]),t._v(" House Emails")]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),a("q-card-section",[t._v("\n          Lorem ipsum dolor sit amet consectetur adipisicing elit. Rerum repellendus sit voluptate voluptas eveniet porro. Rerum blanditiis perferendis totam, ea at omnis vel numquam exercitationem aut, natus minima, porro labore.\n        ")])],1)],1)],1)},o=[],l=(a("e125"),a("4823"),a("2e73"),a("76d0"),a("c880"),a("8e9e")),c=a.n(l),d=a("9ce4"),u=a("d612"),m=a("47783"),p={getAttendance(t,e,a){m["a"].get("/smt/watch/chapel/attendance/"+a).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},postEmail(t,e,a){m["a"].post("/smt/watch/chapel/attendance/"+a).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}},f=a("c286"),b=a("30bd");function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){c()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var v={name:"PageResults",props:{},data(){return{dateString:"",emailPanel:!1,tab:"summary",housetab:"missed",house:"B1",houses:[],data:null,missedColumns:[{name:"id",label:"id",field:"ada_id",type:"string",align:"left",hidden:!0},{name:"name",label:"Name",field:"name",type:"string",align:"left"}],attendedColumns:[{name:"id",label:"id",field:"ada_id",type:"string",align:"left",hidden:!0},{name:"name",label:"Name",field:"name",type:"string",align:"left"}],houseSummaryColumns:[{name:"id",label:"House",field:"id",type:"string",align:"left"},{name:"attended",label:"Attended",field:"attended",type:"string",align:"left"},{name:"privs",label:"Privs",field:"privs",type:"string",align:"left"},{name:"early",label:"Early",field:"early",type:"string",align:"left"},{name:"late",label:"Late",field:"late",type:"string",align:"left"},{name:"talk",label:"Talk",field:"talk",type:"string",align:"left"},{name:"missed",label:"Missed",field:"missed",type:"string",align:"left"}]}},methods:g(g({},Object(d["b"])("sockets",["clearConsoleLog"])),{},{getAttendance(){this.$q.loading.show(),p.getAttendance(this.process,null,this.dateString)},process(t){this.data=t,this.houses=t.allHouses.map((function(t){return{label:t.name,value:t.name}})),this.$q.loading.hide()},dateOptions(t){var e=f["b"].formatDate(t,"ddd");return"Sun"===e},sendHouseEmails(){p.postEmail(this.success,null,this.dateString)}}),computed:{currentHouse(){var t=this;if(!this.data)return{attended:[],missed:[]};var e=this.data.allHouses.find((function(e){return e.name===t.house}));return e},housesSummary(){return this.data?this.data.allHouses.map((function(t){return{id:t.name,attended:t.attended.length,privs:t.priv.length,early:t.sessions.early.length,late:t.sessions.late.length,talk:t.sessions.talk.length,missed:t.missed.length,priv:t.priv}})):[]}},watch:{dateString(){this.getAttendance()}},components:{Crud:u["a"],ConfirmButton:b["a"]},created(){var t=Date.now(),e=f["b"].formatDate(t,"d"),a=f["b"].subtractFromDate(t,{days:e}),s=f["b"].formatDate(a,"DD-MM-YYYY");this.dateString=s,this.getAttendance()}},y=v,q=(a("99e6"),a("2be6")),x=a("2ef0"),w=a("bc74"),P=a("34ff"),O=a("8c18"),D=a("88af"),C=a("ebe6"),k=a("4776"),S=a("dd08"),j=a("f987"),_=a("1411"),Y=a("1d98"),Q=a("3946"),H=a("e81c"),M=a("eb05"),E=a("9f30"),T=a("f85a"),B=a("965d"),A=a("58c0"),$=a("e279"),I=a.n($),L=Object(q["a"])(y,i,o,!1,null,"2f44f317",null),N=L.exports;I()(L,"components",{QBtn:x["a"],QInput:w["a"],QIcon:P["a"],QPopupProxy:O["a"],QDate:D["a"],QCard:C["a"],QTabs:k["a"],QTab:S["a"],QBadge:j["a"],QTabPanels:_["a"],QTabPanel:Y["a"],QSelect:Q["a"],QDialog:H["a"],QToolbar:M["a"],QAvatar:E["a"],QToolbarTitle:T["a"],QCardSection:B["a"]}),I()(L,"directives",{ClosePopup:A["a"]});var R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row fit"},[a("div",{staticClass:" flex-center"},[a("q-btn",{staticClass:"q-mt-md q-mx-lg",attrs:{roundx:"",color:"grey-9",size:"sm",icon:"fal fa-retweet-alt"},on:{click:t.getPrivs}})],1),a("div",{staticClass:"col-4 q-mr-lg"},[a("q-input",{attrs:{filled:"",maskx:"DD-MM-YYYY",dark:""},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{minimal:"",dark:"",mask:"DD-MM-YYYY",options:t.dateOptions,"first-day-of-week":"1"},on:{input:function(){return t.$refs.qDateProxy.hide()}},model:{value:t.privDate,callback:function(e){t.privDate=e},expression:"privDate"}})],1)],1)]},proxy:!0}]),model:{value:t.privDate,callback:function(e){t.privDate=e},expression:"privDate"}})],1)]),a("div",{staticClass:"row fit"},[a("div",{staticClass:"col-6"},[a("h1",[t._v("Total: "+t._s(t.data.count))]),a("crud",{ref:"crud",staticStyle:{max:"height:80vh"},attrs:{dataOverride:t.houses,columns:t.columns,sortBy:"id"}})],1)])])},z=[],J={getPrivs(t,e,a){m["a"].get("/smt/watch/privs/"+a).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}};function F(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function W(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?F(Object(a),!0).forEach((function(e){c()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var G={name:"PageResults",props:{},data(){return{privDate:"",houses:[],data:null,columns:[{name:"id",label:"id",field:"ada_id",type:"string",align:"left",hidden:!0},{name:"name",label:"Name",field:"name",type:"string",align:"left"},{name:"count",label:"Count",field:"count",type:"number",align:"right"}]}},methods:W(W({},Object(d["b"])("sockets",["clearConsoleLog"])),{},{getPrivs(){this.$q.loading.show(),J.getPrivs(this.process,null,this.privDate)},process(t){this.data=t,this.houses=t.houses,this.$q.loading.hide()},dateOptions(t){var e=f["b"].formatDate(t,"ddd");return"Sat"===e}}),computed:{},watch:{privDate(){this.getPrivs()}},components:{Crud:u["a"]},created(){var t=Date.now(),e=6-parseInt(f["b"].formatDate(t,"d")),a=f["b"].addToDate(t,{days:e}),s=f["b"].formatDate(a,"DD-MM-YYYY");this.privDate=s,this.getPrivs()}},K=G,U=(a("cfaa"),Object(q["a"])(K,R,z,!1,null,"2a146e14",null)),V=U.exports;I()(U,"components",{QBtn:x["a"],QInput:w["a"],QIcon:P["a"],QPopupProxy:O["a"],QDate:D["a"]});var X={name:"PageSMTWatch",data(){return{elements:[{name:"chapel",label:"chapel",component:N,shortcut:"c"},{name:"privs",label:"privs",component:V,shortcut:"p"}]}},components:{toolbarPage:r["a"]}},Z=X,tt=Object(q["a"])(Z,s,n,!1,null,null,null);e["default"]=tt.exports},"89ad":function(t,e,a){},"97b2":function(t,e,a){},"99e6":function(t,e,a){"use strict";var s=a("89ad"),n=a.n(s);n.a},cfaa:function(t,e,a){"use strict";var s=a("97b2"),n=a.n(s);n.a}}]);