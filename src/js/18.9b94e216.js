(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"11be":function(e,t,a){"use strict";var r=a("2940"),n=a.n(r);n.a},2940:function(e,t,a){},"8f22":function(e,t,a){"use strict";var r=a("9770"),n=a.n(r);n.a},9770:function(e,t,a){},bd80:function(e,t,a){"use strict";var r=a("c171"),n=a.n(r);n.a},c171:function(e,t,a){},c818:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("toolbar-page",{attrs:{elements:e.elements,default:"almanac"},scopedSlots:e._u([{key:"side",fn:function(){},proxy:!0}])})},n=[],s=a("08e9"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"cal-container",staticStyle:{"overflow-yx":"hidden!important",heightx:"90vh"}},[a("q-toolbar",[a("span",{staticClass:"q-mr-md text-h5"},[e._v(e._s(e.title))]),a("q-input",{ref:"search",staticClass:"col q-mb-none",staticStyle:{"min-width":"200px"},attrs:{placeholder:"Search",clearable:"",dense:"",filled:"","hide-underlines":"",autofocus:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"fad fa-search"}})]},proxy:!0}]),model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),a("span",{staticClass:"q-ml-md"},[a("q-btn-dropdown",{staticClass:"q-mr-md",attrs:{unelevated:"",color:"tertiary",icon:"fad fa-filter"}},[a("q-list",{staticClass:"bd-font"},e._l(e.categories,(function(t){return a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:t.value,class:e.filter===t.label?"bg-tertiary":"",attrs:{clickable:""},on:{click:function(a){return e.clickFilter(t.value)}}},[a("q-item-section",[a("q-item-label",[a("q-btn",{staticClass:"q-mr-md",style:"background: "+t.color,attrs:{size:"xs",dense:"",unelevated:"",label:"",styel:"width:20px"}}),e._v("\n                  "+e._s(t.label)+"\n              ")],1)],1)],1)})),1)],1),a("q-btn",{staticClass:"q-mr-md",attrs:{unelevated:"",color:"tertiary",label:"today"},on:{click:e.today}}),a("q-btn",{attrs:{unelevated:"",color:"tertiary",icon:"fal fa-arrow-left"},on:{click:e.prev}}),a("q-btn",{staticClass:"q-ml-xs",attrs:{unelevated:"",color:"tertiary",icon:"fal fa-arrow-right"},on:{click:e.next}})],1)],1),a("div",{staticClass:"demo-container",staticStyle:{"overflow-y":"hidden!important"},style:{height:e.height}},[a("FullCalendar",{ref:"fullCalendar",staticClass:"q-ma-xs",staticStyle:{height:"200px","overflow-y":"scroll","z-index":"-1"},attrs:{id:"cal",defaultViewx:"timeGridWeek",defaultView:"dayGridMonth",plugins:e.calendarPlugins,slotDuration:"00:30:00",header:!1,weekends:!0,height:"parent",contentHeightx:"2000",minTime:"08:00",maxTime:"23:00",events:e.filteredEvents,eventLimit:4,eventTimeFormats:{hour:"2-digit",minute:"2-digit",secondx:"2-digit",meridiem:!1}}})],1)],1)},c=[],i=(a("632c"),a("06ef"),a("47783")),o={getAlmanac(e,t,a){i["a"].get("/home/almanac").then((function(t){e(t.data)})).catch((function(e){console.log(e)}))},getTerms(e,t,a){i["a"].get("/admin/school/terms/"+a).then((function(t){e(t.data)})).catch((function(e){console.log(e)}))}},d=a("b9bf"),h=a("dcc7"),u=a("df78"),m={name:"Home.Almanac.Calandar",props:{},data(){return{search:"",rawEvents:[],calendarPlugins:[h["d"],u["a"]],title:"",calendarApi:null,filter:""}},methods:{process(e){this.rawEvents=e,this.calendarApi=this.$refs.fullCalendar.getApi(),this.calendarApi.render(),this.setTitle()},fetch(){o.getAlmanac(this.process)},setTitle(){this.title=this.calendarApi.view.title},next(){this.calendarApi.next(),this.setTitle()},prev(){this.calendarApi.prev(),this.setTitle()},today(){this.calendarApi.today(),this.setTitle()},clickFilter(e){this.filter=e},getColor(e){var t=this.categories.find((function(t){return t.label===e}));return t.color}},computed:{events(){var e=this;return this.rawEvents.map((function(t){var a=e.getColor(t.category);return{start:t.startISO,end:t.endTime,title:t.description,category:t.category,backgroundColor:a,borderColor:a}}))},filteredEvents(){var e=this.search.toLowerCase(),t=this.events;""!==e&&(t=this.events.filter((function(t){return t.title.toLowerCase().indexOf(e)>-1})));var a=this.filter.toLowerCase();return""===a?t:t.filter((function(e){return e.category.toLowerCase().indexOf(a)>-1}))},height(){return"calc(100vh - 250px)"},categories(){var e=this.$parseOptions(this.rawEvents,"category");e.sort((function(e,t){return e.label>t.label?1:-1}));var t=this;return e.forEach((function(e,a){e.color=t.$hexPalette(a)})),e.unshift({label:"NONE",value:"",color:""}),console.log(e),e}},components:{FullCalendar:d["a"]},created(){this.fetch()}},f=m,p=(a("bd80"),a("8f22"),a("2be6")),v=a("8c42"),g=a("eb05"),D=a("bc74"),b=a("34ff"),k=a("5f53"),y=a("6c93"),x=a("ac9b"),w=a("66dc"),C=a("7d9a"),S=a("2ef0"),q=a("dfd0"),E=a("58c0"),A=a("e279"),T=a.n(A),_=Object(p["a"])(f,l,c,!1,null,null,null),Q=_.exports;T()(_,"components",{QPage:v["a"],QToolbar:g["a"],QInput:D["a"],QIcon:b["a"],QBtnDropdown:k["a"],QList:y["a"],QItem:x["a"],QItemSection:w["a"],QItemLabel:C["a"],QBtn:S["a"],QColor:q["a"]}),T()(_,"directives",{ClosePopup:E["a"]});var P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{},[a("div",{staticClass:"row fit",staticStyle:{height:"90vh"}},[a("div",{staticClass:"col fit",staticStyle:{height:"90vh"}},[a("Calendar",{key:e.calIndex,ref:"calendar",staticStyle:{"min-height":"90vh"},attrs:{"week-start":"1",year:e.year,"enable-range-selection":!0,"data-source":e.calendarData,sync:""},on:{"click-day":e.clickDay,"year-changed":e.changeYear}})],1)])])},$=[],I=(a("c880"),a("4fb0"),a("2cc0")),O=a.n(I),B=a("134d"),L={name:"Component.Admin.School.Calendar",props:{},data(){return{terms:[],newModeOn:!0,calIndex:0,year:null,eventId:0,showWeeks:!0}},methods:{changeYear(e){var t=e.currentYear;t!==this.year&&(this.year=t,o.getTerms(this.processTerms,this.$errorHandler,t))},processTerms(e){this.terms=e,this.calendarData()},makeDate(e){if(!e)return null;var t=e.split(" ")[0],a=t.split("-")[0],r=t.split("-")[1],n=t.split("-")[2];return new Date(n,r-1,a)},calendarData(){var e=[],t="black",a=this;return this.terms.forEach((function(r,n){var s=r.isPublished?a.$hexPalette(n):B["a"].getBrand("font-secondary");a.showWeeks||e.push({name:r.name,startDate:a.makeDate(r.start),endDate:a.makeDate(r.end),color:s}),e.push({startDate:a.makeDate(r.htStart),endDate:a.makeDate(r.htEnd),color:t}),e.push({startDate:a.makeDate(r.htStart),endDate:a.makeDate(r.htEnd),color:t}),e.push({startDate:a.makeDate(r.htStart),endDate:a.makeDate(r.htEnd),color:t}),e.push({startDate:a.makeDate(r.ex1Start),endDate:a.makeDate(r.ex1End),color:t}),e.push({startDate:a.makeDate(r.ex1Start),endDate:a.makeDate(r.ex1End),color:t}),e.push({startDate:a.makeDate(r.ex1Start),endDate:a.makeDate(r.ex1End),color:t}),e.push({startDate:a.makeDate(r.ex2Start),endDate:a.makeDate(r.ex2End),color:t}),e.push({startDate:a.makeDate(r.ex2Start),endDate:a.makeDate(r.ex2End),color:t}),e.push({startDate:a.makeDate(r.ex2Start),endDate:a.makeDate(r.ex2End),color:t}),a.showWeeks&&r.weeks.forEach((function(t,r){"B"!==t.type&&"A"!==t.type||e.push({startDate:a.makeDate(t.wb),endDate:a.makeDate(t.we),color:"B"===t.type?B["a"].getBrand("accent"):B["a"].getBrand("positive")})}))})),this.$refs.calendar.calendar&&this.$refs.calendar.calendar.setDataSource(e),e}},computed:{},components:{Calendar:O.a},created(){this.calendarData()}},F=L,H=(a("11be"),Object(p["a"])(F,P,$,!1,null,"7c14c0f3",null)),W=H.exports;T()(H,"components",{QPage:v["a"]});var j={name:"PageHomeAlmanac",data(){return{elements:[{name:"almanac",label:"Almanac",component:Q,shortcut:"b"},{name:"terms",label:"Terms",component:W,shortcut:"b"}]}},components:{toolbarPage:s["a"]},methods:{}},N=j,Y=Object(p["a"])(N,r,n,!1,null,null,null);t["default"]=Y.exports}}]);