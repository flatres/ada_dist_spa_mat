(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[43],{"61dc":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-page",{staticClass:"no-scroll full-height full-width toolbar-page fixed q-pr-xl q-pa-md column"},[e("div",{staticClass:"row q-pr-xl"},[e("year-bar",{staticClass:"ybx-border",attrs:{"exams-only":""}}),e("q-space"),e("q-btn",{staticClass:"a-btn",attrs:{flat:"",label:"Fetch Statistics",icon:"fad fa-file-chart-line"}}),e("q-btn",{staticClass:"a-btn on-right",attrs:{flat:"",label:"Upload TAG Sheet",icon:"fad fa-upload"},on:{click:function(a){t.uploadOpen=!0}}})],1),e("div",{staticClass:"q-pr-sm col column q-pt-lg q-mb-xl q-pb-xl"},[e("q-table",{staticClass:"my-sticky-header-table col column",attrs:{dense:"",data:t.exams,columns:t.columns,"row-key":"id",stylex:"width:700px",flat:"",pagination:{rowsPerPage:1e3}},scopedSlots:t._u([{key:"body",fn:function(a){return[e("q-tr",{staticClass:"wyap-table",attrs:{props:a}},[e("q-td",{key:"examName",attrs:{props:a,"auto-width":""}},[t._v("\n          "+t._s(a.row.examName)+"\n        ")]),e("q-td",{key:"examCode",attrs:{props:a,"auto-width":""}},[t._v("\n          "+t._s(a.row.examCode)+"\n        ")]),e("q-td",{key:"sa1",attrs:{props:a,"auto-width":""}},[t.summerAssessments(a.row).length>0?e("div",{staticClass:"fit bg-accent rounded",class:t.saResultsCount(a.row,1)>0?"bg-accent":"bg-warning"},[e("span",{staticClass:"text-font-negative ",staticStyle:{"font-size":"10px"}},[t._v(t._s(t.saResultsCount(a.row,1)))])]):t._e()]),e("q-td",{key:"sa2",attrs:{props:a,"auto-width":""}},[t.summerAssessments(a.row).length>1?e("div",{staticClass:"fit bg-accent",class:t.saResultsCount(a.row,2)>0?"bg-accent":"bg-warning"},[e("span",{staticClass:"text-font-negative",staticStyle:{"font-size":"10px"}},[t._v(t._s(t.saResultsCount(a.row,2)))])]):t._e()]),e("q-td",{key:"sa3",attrs:{props:a,"auto-width":""}},[t.summerAssessments(a.row).length>2?e("div",{staticClass:"fit bg-accent",class:t.saResultsCount(a.row,3)>0?"bg-accent":"bg-warning"},[e("span",{staticClass:"text-font-negative",staticStyle:{"font-size":"10px"}},[t._v(t._s(t.saResultsCount(a.row,3)))])]):t._e()]),e("q-td",{key:"nea",attrs:{props:a,"auto-width":""}},[t.hasNEA(a.row)?e("div",{staticClass:"fit bg-accent",class:t.neaResultsCount(a.row)>0?"bg-accent":"bg-warning"},[e("span",{staticClass:"text-font-negative",staticStyle:{"font-size":"10px"}},[t._v(t._s(t.neaResultsCount(a.row,1)))])]):t._e()]),e("q-td",{key:"w1",attrs:{props:a,"auto-width":""}},[t.wyaps(a.row).length>0?e("div",{staticClass:"fit flex items-center justify-center",class:t.wyapResultsCount(a.row,1)>0?"bg-accent":"bg-warning"},[e("span",{staticClass:"text-font-negative",staticStyle:{"font-size":"10px"}},[t._v(t._s(t.wyapResultsCount(a.row,1)))])]):t._e()]),e("q-td",{key:"w2",attrs:{props:a,"auto-width":""}},[t.wyaps(a.row).length>1?e("div",{staticClass:"fit flex items-center justify-center",class:t.wyapResultsCount(a.row,2)>0?"bg-accent":"bg-warning"},[e("span",{staticClass:"text-font-negative",staticStyle:{"font-size":"10px"}},[t._v(t._s(t.wyapResultsCount(a.row,2)))])]):t._e()]),e("q-td",{key:"w3",attrs:{props:a,"auto-width":""}},[t.wyaps(a.row).length>2?e("div",{staticClass:"fit flex items-center justify-center",class:t.wyapResultsCount(a.row,3)>0?"bg-accent":"bg-warning"},[e("span",{staticClass:"text-font-negative",staticStyle:{"font-size":"10px"}},[t._v(t._s(t.wyapResultsCount(a.row,3)))])]):t._e()]),e("q-td",{key:"w4",attrs:{props:a,"auto-width":""}},[t.wyaps(a.row).length>3?e("div",{staticClass:"fit flex items-center justify-center",class:t.wyapResultsCount(a.row,4)>0?"bg-accent":"bg-warning"},[e("span",{staticClass:"text-font-negative",staticStyle:{"font-size":"10px"}},[t._v(t._s(t.wyapResultsCount(a.row,4)))])]):t._e()]),e("q-td",{key:"w5",attrs:{props:a,"auto-width":""}},[t.wyaps(a.row).length>4?e("div",{staticClass:"fit flex items-center justify-center",class:t.wyapResultsCount(a.row,5)>0?"bg-accent":"bg-warning"},[e("span",{staticClass:"text-font-negative",staticStyle:{"font-size":"10px"}},[t._v(t._s(t.wyapResultsCount(a.row,5)))])]):t._e()]),e("q-td")],1)]}}])})],1),e("q-dialog",{attrs:{positionX:"top",persistent:""},model:{value:t.uploadOpen,callback:function(a){t.uploadOpen=a},expression:"uploadOpen"}},[e("q-card",{staticClass:"bg-primary bd-font-secondary",staticStyle:{"min-width":"35%"}},[e("q-bar",{staticClass:"bg-secondary"},[e("span",[t._v("File Upload")]),e("q-space"),e("q-btn",{attrs:{dense:"",icon:"fas fa-times",size:"xs",flat:"",color:"font"},on:{click:t.cancel}})],1),e("q-card-section",[e("q-file",{staticClass:"full-width text-font",attrs:{label:"Select File",outlined:"",dense:"",color:"font",accept:".xlsx"},model:{value:t.uploadFile,callback:function(a){t.uploadFile=a},expression:"uploadFile"}}),e("br"),e("q-btn",{staticClass:"full-width a-btn q-mb-sm",attrs:{disabled:!t.uploadFile,loading:t.uploadingInitial,label:"upload",icon:"fad fa-upload"},on:{click:t.uploadInitial}}),e("br"),t.initialUploaded&&t.initialError?e("div",[e("q-scroll-area",{staticClass:"full-width bd-font-secondary",staticStyle:{height:"100px"}},[e("span",{staticClass:"full-width text-left q-my-md text-bold text-warning"},[t._v("Error!!!")]),e("p",{staticClass:"text-warning",domProps:{innerHTML:t._s(t.initialErrorMsg)}})])],1):t._e(),t.initialUploaded&&!t.initialError?e("div",[e("span",{staticClass:"full-width text-left q-my-md text-bold"},[t._v("Verify Details")]),e("p",{staticClass:"q-mb-none q-ml-xs"},[t._v("Exam: "+t._s(t.initialData.exam.examName))]),e("p",{staticClass:"q-mb-none q-ml-xs"},[t._v("Level: "+t._s(t.initialData.exam.year>11?"A Level / Pre U":"GCSE"))]),e("p",{staticClass:"q-mb-none q-ml-xs"},[t._v(t._s(t.initialData.students.length)+" students")])]):t._e(),e("br"),e("div",{staticClass:"row"},[e("q-btn",{staticClass:"col a-btn",attrs:{label:"Cancel"},on:{click:t.cancel}}),e("q-btn",{staticClass:"col a-btn on-right",attrs:{loading:t.uploadingFinal,disabled:!t.uploadInfo&&!t.initialError,label:"Submit",icon:"fad fa-praying-hands"},on:{click:t.uploadFinal}})],1)],1)],1)],1)],1)},i=[],n=(e("e125"),e("4823"),e("2e73"),e("76d0"),e("632c"),e("8e9e")),l=e.n(n),r=e("6247"),o=e("47783"),c={getWyaps(t,a,e){o["a"].get("/dha/wyaps/year/"+e).then((function(a){t(a.data)})).catch((function(t){console.log(t)}))},postInitialUpload(t,a,e){var s=new FormData;s.append("file",e),o["a"].post("/dha/tags/upload/initial",s,{headers:{"Content-Type":"multipart/form-data"}}).then((function(a){t(a.data)})).catch((function(t){console.log(t)}))},postFinalUpload(t,a,e,s){var i=new FormData;i.append("file",e),o["a"].post("/dha/tags/upload/final/"+s.id+"/"+s.examCode+"/"+s.year,i,{headers:{"Content-Type":"multipart/form-data"}}).then((function(a){t(a.data)})).catch((function(t){console.log(t)}))}},p=e("9ce4");function d(t,a){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter((function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),e.push.apply(e,s)}return e}function u(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?d(Object(e),!0).forEach((function(a){l()(t,a,e[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):d(Object(e)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))}))}return t}var f={name:"PageDha",data(){return{exams:[],columns:[{name:"examName",required:!0,label:"Exam Name",align:"left",field:"examName",sortable:!0},{name:"examCode",align:"left",label:"Code"},{name:"sa1",align:"center",label:"SA1"},{name:"sa2",align:"center",label:"SA2"},{name:"sa3",align:"center",label:"SA3"},{name:"nea",align:"center",label:"NEA"},{name:"w1",align:"center",label:"WY1"},{name:"w2",align:"center",label:"WY2"},{name:"w3",align:"center",label:"WY3"},{name:"w4",align:"center",label:"WY4"},{name:"w5",align:"center",label:"WY5"}],uploadOpen:!1,uploadFile:null,uploadInfo:null,uploadingInitial:!1,initialUploaded:!1,initialError:!1,initialErrorMsg:"",initialData:{},finalError:!1,uploadingFinal:!1,finalUploaded:!1}},computed:u({},Object(p["c"])("dha",["activeYear"])),methods:u(u({},Object(p["d"])("dha",["setActiveYear"])),{},{getWyaps(){this.$startLoading(),c.getWyaps(this.processWyaps,this.$errorHandler,this.activeYear)},processWyaps(t){this.$endLoading(),this.exams=t.sort(this.$compare("examName","asc"))},summerAssessments(t){return t.wyaps.filter((function(t){return"SA"===t.typeShort}))},hasNEA(t){return t.wyaps.filter((function(t){return"NEA"===t.typeShort})).length>0},wyaps(t){return t.wyaps.filter((function(t){return"WYAP"===t.typeShort}))},wyapResultsCount(t,a){var e=t.wyaps.filter((function(t){return"WYAP"===t.typeShort}));if(e[a-1]){var s=e[a-1];return s.resultsCount}},saResultsCount(t,a){var e=t.wyaps.filter((function(t){return"SA"===t.typeShort}));if(e[a-1]){var s=e[a-1];return s.resultsCount}},neaResultsCount(t){var a=1,e=t.wyaps.filter((function(t){return"NEA"===t.typeShort}));if(e[a-1]){var s=e[a-1];return s.resultsCount}},cancel(){this.initialData={},this.uploadOpen=!1,this.uploadInfo=null,this.initialError=!1,this.uploadingInitial=!1,this.initialUploaded=!1,this.uploadingFinal=!1,this.finalUploaded=!1,this.finalError=!1},uploadInitial(){this.uploadFile&&(this.uploadingInitial=!0,c.postInitialUpload(this.processInitial,this.initialUploadError,this.uploadFile))},processInitial(t){this.initialError=t.error,this.uploadInfo=t.info,this.uploadingInitial=!1,this.initialUploaded=!0,t.error&&(this.initalError=!0,this.initialErrorMsg=t.msg),this.initialData=t},initialUploadError(t){console.error(t),this.uploadingInitial=!1,this.initalError=!1},uploadFinal(){this.uploadFile&&(this.uploadingFinal=!0,c.postFinalUpload(this.processFinal,this.finalUploadError,this.uploadFile,this.initialData.exam))},finalUploadError(t){console.error(t),this.uploadingFinal=!1,this.finalError=!0},processFinal(){this.uploadingFinal=!1}}),components:{YearBar:r["a"]},created(){var t=this;this.setActiveYear(13),this.yearWatch=this.$store.watch((function(){return t.$store.getters["dha/activeYear"]}),this.getWyaps),this.getWyaps()},beforeDestroy(){this.yearWatch&&this.yearWatch()}},h=f,g=(e("a5a2"),e("2be6")),w=e("8c42"),b=e("f962c"),y=e("2ef0"),m=e("18f0"),C=e("41c9"),x=e("b74b"),v=e("e81c"),q=e("ebe6"),_=e("5d16"),S=e("965d"),E=e("2050"),F=e("26a8"),O=e("dfd0"),k=e("e279"),A=e.n(k),R=Object(g["a"])(h,s,i,!1,null,null,null);a["default"]=R.exports;A()(R,"components",{QPage:w["a"],QSpace:b["a"],QBtn:y["a"],QTable:m["a"],QTr:C["a"],QTd:x["a"],QDialog:v["a"],QCard:q["a"],QBar:_["a"],QCardSection:S["a"],QFile:E["a"],QScrollArea:F["a"],QColor:O["a"]})},a5a2:function(t,a,e){"use strict";var s=e("bbda"),i=e.n(s);i.a},bbda:function(t,a,e){}}]);