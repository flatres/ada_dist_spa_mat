(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{3377:function(t,e,s){},"456f":function(t,e,s){},ab73:function(t,e,s){"use strict";var a=s("3377"),n=s.n(a);n.a},d497:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.getGlobalSubject?s("q-page",{},[s("exam-bar",{staticClass:"bg-tertiary",on:{loaded:function(e){t.showClasses=!0}}}),s("loading",{attrs:{loading:t.autoAssigning,messagex:t.autoCount+" / "+t.meetingsCount}}),!t.autoAssigning&&t.showClasses?s("div",{staticClass:"row full-width bg-secondary q-ma-md q-pl-md"},[s("div",{staticClass:"col"},[s("classes",{attrs:{classes:t.classes},on:{"update:classes":function(e){t.classes=e},publish:t.teachers}})],1),s("div",{staticClass:"ada-sidebar q-mx-sm"},[s("div",{staticClass:"full-width text-center bg-tertiary q-pb-lg"},[s("q-circular-progress",{staticClass:"text-white q-ma-md",attrs:{"show-value":"",value:t.progress,size:"90px",thickness:.2,color:"accent","center-color":"tertiary","track-color":"secondary",max:1}},[s("div",{staticClass:"absolute-full flex flex-center",staticStyle:{"font-size":"14px"}},[t._v("\n            "+t._s(t.bookedCount)+" / "+t._s(t.meetingsCount)+"\n          ")])]),s("div",{staticClass:"row full-width q-px-md q-mb-md"},[s("q-btn",{staticClass:"full-width",attrs:{outline:"",color:"accent",label:"Auto Assign"},on:{click:t.autoAssign}})],1),s("div",{staticClass:"row full-width q-px-md q-mb-md"},[s("q-btn",{staticClass:"full-width",attrs:{outline:"",color:"font",label:"Download",iconx:"fad fa-download"},on:{click:t.download}})],1),t.teachers.length>0?s("q-markup-table",{staticClass:"q-mx-md",attrs:{dense:"",flat:"",bordered:""}},[s("tbody",t._l(t.teachers,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"text-left"},[t._v(t._s(e.name))]),s("td",{staticClass:"text-left"},[t._v(t._s(e.count))])])})),0)]):t._e()],1)])]):t._e()],1):t._e()},n=[],i=(s("e125"),s("4823"),s("2e73"),s("76d0"),s("632c"),s("8e9e")),o=s.n(i),l=s("10ac"),r=s("9ce4"),c=s("89cf"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("loading",{attrs:{loading:t.loadingClasses}}),!t.loadingClasses&&t.show&&t.classes.length>0?s("div",{staticClass:"row no-wrap q-px-xs q-pt-xs text-left",staticStyle:{"padding-bottom":"200px"}},[s("div",{staticClass:"q-mr-md",staticStyle:{"min-width":"150px"}},[s("q-scroll-area",{staticStyle:{height:"80vh"}},[s("q-list",{staticClass:"no-padding"},t._l(t.classes,(function(e){return s("q-item",{key:e.code,staticClass:"q-pa-xs text-white bg-tertiary q-my-xs",class:e.id===t.selectedClassId?"active-class":"",style:e.id===t.selectedClassId?"border: 2px solid black":"border: 1px solid grey",attrs:{clickable:"",group:"classes",dense:""},on:{click:function(s){return t.setClass(e.id)}}},[s("q-item-section",[s("q-item-label",{staticClass:"xrow"},[s("q-btn",{staticClass:"fullx-width",attrs:{flat:"",color:"font",label:e.code,dense:"","no-caps":"",size:"12px"}})],1)],1),s("q-item-section",{attrs:{side:""}},[t.classComplete(e)?s("q-icon",{attrs:{name:"fad fa-check",color:"positive"}}):t._e()],1)],1)})),1)],1)],1),s("div",{staticClass:"col"},[s("loading",{attrs:{loading:t.loading}}),!t.loading&&t.selectedClass?s("q-markup-table",{attrs:{dense:"",flat:"",bordered:""}},[s("thead",{staticClass:"q-mb-md"},[s("tr",{staticClass:"bg-tertiary"},[s("th",{staticClass:"text-left"},[t._v("Name")]),s("th",{staticClass:"text-left"},[t._v("Class")]),s("th",[t._v("Meeting Beak\n            ")])])]),s("tbody",t._l(t.selectedClass.students,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"text-left"},[t._v(t._s(e.fullName))]),s("td",{staticClass:"text-left"},[t._v(t._s(t.classCode))]),s("td",[s("q-btn-toggle",{staticClass:"no-shadow",attrs:{spread:"",outline:!e.meetingBeakId,dense:"","no-caps":"","toggle-color":"tertiary",color:"secondary","text-color":e.meetingBeakId?"grey-5":"warning",options:t.beakOptions},on:{input:function(s){return t.setBeak(e)}},model:{value:e.meetingBeakId,callback:function(s){t.$set(e,"meetingBeakId",s)},expression:"s.meetingBeakId"}})],1)])})),0)]):t._e()],1)]):t._e()],1)},u=[],h=s("0603"),g={name:"HOD.Data.MLO",props:{},data(){return{year:null,exam:null,subject:null,students:[],maxMLOCount:4,classes:[],selectedClassId:null,selectedClass:null,show:!1,exams:[],teachers:[],loading:!1,loadingClasses:!0}},methods:{classComplete(t){var e=t.students.filter((function(t){return t.meetingBeakId})).length;return e===t.students.length},setBeak(t){h["a"].setMeeting(this.publish,this.$errorHandler,t.id,t.meetingBeakId,t.classId),console.log(t)},publish(){this.$emit("update:classes",this.classes)},processClasses(t){this.classes=t,this.loadingClasses=!1,this.classes.length>0&&(this.show=!0,this.setClass(this.classes[0].id)),this.publish()},getMeetingClasses(){console.log("gmc",this.$store.getters["user/getGlobalSubject"]),this.loadingClasses=!0,h["a"].getMeetingClasses(this.processClasses,this.$errorFunction)},setClass(t){this.selectedClassId=t,this.selectedClass=this.classes.find((function(e){return e.id===t}))}},computed:{classCode(){return this.selectedClass.code},beakOptions(){var t=this.selectedClass.teachers.map((function(t){return{label:t.login,value:t.id}}));return t}},components:{Loading:l["a"]},mounted(){this.getMeetingClasses()},created(){var t=this;this.subject=this.$store.getters["user/getGlobalSubject"],this.yearWatch=this.$store.watch((function(){return t.$store.getters["hod/activeYear"]}),this.getMeetingClasses),this.examWatch=this.$store.watch((function(){return t.$store.getters["hod/activeExam"]}),this.getMeetingClasses)},beforeDestroy(){this.subjectWatch(),this.yearWatch(),this.examWatch()}},f=g,m=(s("fc54"),s("2be6")),b=s("26a8"),p=s("6c93"),C=s("ac9b"),v=s("66dc"),w=s("7d9a"),x=s("2ef0"),k=s("34ff"),y=s("2e0b"),q=s("6dd6"),O=s("e279"),_=s.n(O),j=Object(m["a"])(f,d,u,!1,null,"507535a6",null),I=j.exports;function B(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function $(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?B(Object(s),!0).forEach((function(e){o()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):B(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}_()(j,"components",{QScrollArea:b["a"],QList:p["a"],QItem:C["a"],QItemSection:v["a"],QItemLabel:w["a"],QBtn:x["a"],QIcon:k["a"],QMarkupTable:y["a"],QBtnToggle:q["a"]});var A={name:"Page.HOD.Meetings",data(){return{classes:[],autoAssigning:!1,autoCount:0,showClasses:!1}},computed:$($({},Object(r["c"])("user",["getGlobalSubject"])),{},{meetingsCount(){var t=0;return this.classes.forEach((function(e){t+=e.students.length})),t},bookedCount(){var t=0;return this.classes.forEach((function(e){t+=e.students.filter((function(t){return t.meetingBeakId})).length})),t},teachers(){var t=[];return this.classes.forEach((function(e){e.students.forEach((function(s){var a=t.find((function(t){return t.id===s.meetingBeakId}));if(a)a.count++;else{var n=e.teachers.find((function(t){return t.id===s.meetingBeakId}));n&&t.push({name:n.login,id:n.id,count:1})}}))})),t.sort(this.$compare("name")),t},progress(){return 0===this.meetingsCount?0:this.bookedCount/this.meetingsCount}}),methods:$($({},Object(r["d"])("hod",["setActiveYear"])),{},{autoAssign(){var t=this;this.$q.dialog({title:"Confirm",message:"Would you like to automatically assign beaks to pupils?",cancel:!0,persistent:!0}).onOk((function(){t.doAutoAssign()})).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}))},doAutoAssign(){var t=this;this.autoAssigning=!0,this.autoCount=0,this.classes.forEach((function(e){var s=0,a=e.teachers.length;e.students.forEach((function(n){var i=e.teachers[s%a].id;h["a"].setMeeting((function(e){n.meetingBeakId=i,t.autoCount++,1===t.progress&&(t.autoAssigning=!1)}),t.$errorHandler,n.id,i,e.id),s++}))}))},download(){var t=this;h["a"].download((function(e){t.$downloadBlob(e.url,e.file)}),this.$errorHandler)}}),components:{ExamBar:c["a"],Classes:I,Loading:l["a"]},created(){this.setActiveYear(12)},beforeDestroy(){}},M=A,Q=(s("ab73"),s("8c42")),E=s("cf19"),S=Object(m["a"])(M,a,n,!1,null,null,null);e["default"]=S.exports;_()(S,"components",{QPage:Q["a"],QCircularProgress:E["a"],QBtn:x["a"],QMarkupTable:y["a"]})},fc54:function(t,e,s){"use strict";var a=s("456f"),n=s.n(a);n.a}}]);