(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[76],{"5fcd":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("toolbar-page",{attrs:{elements:t.elements,default:"tests"}})},l=[],i=e("08e9"),r=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticStyle:{"overflow-y":"scroll"}},[e("div",{staticClass:"row"},[e("q-btn-toggle",{staticClass:"text-positive q-mr-lg",attrs:{outline:"","text-color":"font-secondary","toggle-text-color":"positive",options:[{label:"Alert Today",value:"alert_today"},{label:"Any Alert",value:"alert_any"},{label:"All",value:"all"}]},model:{value:t.filterModel,callback:function(s){t.filterModel=s},expression:"filterModel"}}),e("q-input",{staticClass:"col",attrs:{dense:"",outline:"",color:"font",placeholder:"Search"},model:{value:t.search,callback:function(s){t.search=s},expression:"search"}})],1),e("div",{staticClass:"row fit"},[e("div",{staticClass:"col q-mt-md"},[e("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[t.loading?t._e():e("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[e("thead",{staticClass:"q-mb-md"},[e("tr",{staticClass:"bg-tertiary"},[e("th",{staticClass:"text-left",on:{click:function(s){return t.setSort("name")}}},[t._v("Name")]),e("th",{staticClass:"text-left",on:{click:function(s){return t.setSort("boardingHouse")}}},[t._v("House")]),e("th",{staticClass:"text-left",on:{click:function(s){return t.setSort("NCYear")}}},[t._v("Yr")]),t._l(t.dates,(function(s){return e("th",{key:s.date,staticClass:"text-left"},[t._v(t._s(s.prettyDate))])})),e("th",{staticClass:"text-left"})],2)]),e("tbody",t._l(t.sorted,(function(s){return e("tr",{key:s.id},[e("td",{staticClass:"text-left"},[t._v(t._s(s.lastname+",  "+s.prename))]),e("td",{staticClass:"text-left"},[t._v(t._s(s.boardingHouse))]),e("td",{staticClass:"text-left"},[t._v(t._s(s.NCYear))]),t._l(t.dates,(function(t){return e("td",{key:t.date,staticClass:"text-left"},[e("answer",{attrs:{person:s,date:t.date}})],1)})),e("td",{staticClass:"text-left"})],2)})),0)])],1)],1)])])},o=[],n=(e("632c"),e("a7e1"),e("76d0"),e("06ef"),e("1bfa")),c=e("0142"),d={name:"smt.covid.students",props:{},data(){return{students:[],search:"",filterModel:"alert_today",loading:!0,dates:[],sortKey:"lastname",sortDir:"asc"}},methods:{process(t){this.$q.loading.hide(),this.loading=!1,this.students=t.students,this.dates=t.dates},setSort(t){t===this.sortKey&&(this.sortDir="asc"===this.sortDir?"desc":"asc"),this.sortKey=t}},computed:{visible(){var t=this,s=this.search,e=[];return e="alert_today"===this.filterModel?this.students.filter((function(s){var e=t.dates[0].date,a=s.answers.find((function(t){return t.date===e}));if(a)return 0===a.isHealthy&&1===a.hasAnswered})):"alert_any"===this.filterModel?this.students.filter((function(t){if(t.answers[0])return t.answers.find((function(t){return 0===t.isHealthy&&1===t.hasAnswered}))})):this.students,""===s?e:e.filter((function(t){return t.firstname.toLowerCase().indexOf(s)>-1||t.lastname.toLowerCase().indexOf(s)>-1||t.prename.toLowerCase().indexOf(s)>-1||t.boardingHouse.toLowerCase().indexOf(s)>-1||t.NCYear.toString().toLowerCase().indexOf(s)>-1}))},sorted(){var t=this.visible.filter((function(t){return t.id>0}));return t.sort(this.$compare(this.sortKey,this.sortDir))}},components:{Answer:c["a"]},created(){this.$q.loading.show(),n["a"].getStudents(this.process,this.$errorHandler)}},u=d,f=e("2be6"),h=e("6dd6"),m=e("bc74"),p=e("26a8"),v=e("2e0b"),b=e("e279"),C=e.n(b),g=Object(f["a"])(u,r,o,!1,null,"86da297a",null),q=g.exports;C()(g,"components",{QBtnToggle:h["a"],QInput:m["a"],QScrollArea:p["a"],QMarkupTable:v["a"]});var x=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticStyle:{"overflow-y":"scroll"}},[e("div",{staticClass:"row"},[e("q-btn-toggle",{staticClass:"text-positive q-mr-lg",attrs:{outline:"","text-color":"font-secondary","toggle-text-color":"positive",options:[{label:"Alert Today",value:"alert_today"},{label:"Any Alert",value:"alert_any"},{label:"All",value:"all"}]},model:{value:t.filterModel,callback:function(s){t.filterModel=s},expression:"filterModel"}}),e("q-input",{staticClass:"col",attrs:{dense:"",outline:"",color:"font",placeholder:"Search"},model:{value:t.search,callback:function(s){t.search=s},expression:"search"}})],1),e("div",{staticClass:"row fit"},[e("div",{staticClass:"col q-mt-md"},[e("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[t.loading?t._e():e("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[e("thead",{staticClass:"q-mb-md"},[e("tr",{staticClass:"bg-tertiary"},[e("th",{staticClass:"text-left"},[t._v("Name")]),t._l(t.dates,(function(s){return e("th",{key:s.date,staticClass:"text-left"},[t._v(t._s(s.prettyDate))])})),e("th",{staticClass:"text-left"})],2)]),e("tbody",t._l(t.visible,(function(s){return e("tr",{key:s.id},[e("td",{staticClass:"text-left"},[t._v(t._s(s.firstname+" "+s.lastname))]),t._l(t.dates,(function(t){return e("td",{key:t.date,staticClass:"text-left"},[e("answer",{attrs:{person:s,date:t.date}})],1)}))],2)})),0)])],1)],1)])])},w=[],_={name:"smt.covid.staff",props:{},data(){return{staff:[],search:"",filterModel:"alert_today",loading:!0,dates:[]}},methods:{process(t){this.$q.loading.hide(),this.loading=!1,this.staff=t.staff,this.dates=t.dates}},computed:{visible(){var t=this,s=this.search,e=[];return e="alert_today"===this.filterModel?this.staff.filter((function(s){var e=t.dates[0].date,a=s.answers.find((function(t){return t.date===e}));if(a)return 0===a.isHealthy&&1===a.hasAnswered})):"alert_any"===this.filterModel?this.staff.filter((function(t){if(t.answers[0])return t.answers.find((function(t){return 0===t.isHealthy&&1===t.hasAnswered}))})):this.staff,""===s?e:e.filter((function(t){return t.firstname.toLowerCase().indexOf(s)>-1||t.lastname.toLowerCase().indexOf(s)>-1}))}},components:{Answer:c["a"]},created(){this.$q.loading.show(),n["a"].getStaff(this.process,this.$errorHandler)}},y=_,S=Object(f["a"])(y,x,w,!1,null,"1161f256",null),k=S.exports;C()(S,"components",{QBtnToggle:h["a"],QInput:m["a"],QScrollArea:p["a"],QMarkupTable:v["a"]});var A=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"col column",staticStyle:{"overflow-y":"scroll"}},[e("q-tabs",{attrs:{align:"left","indicator-color":"accent",dense:""},model:{value:t.tab,callback:function(s){t.tab=s},expression:"tab"}},[e("q-tab",{attrs:{label:"New",name:"new"}}),e("q-tab",{attrs:{label:"Archive",name:"archive"}})],1),e("q-tab-panels",{staticClass:"col column a-width-restrict q-pb-xl",model:{value:t.tab,callback:function(s){t.tab=s},expression:"tab"}},[e("q-tab-panel",{staticClass:"col column q-pl-none",attrs:{name:"new"}},[e("div",{staticClass:"col q-mt-md"},[e("p",{staticClass:"text-font"},[t._v("Update the master spreadsheet with the data below and then press log to clear from the list.")]),e("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[e("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[e("thead",{staticClass:"q-mb-md"},[e("tr",{staticClass:"bg-tertiary"},[e("th",{staticClass:"text-left"},[t._v("Name")]),e("th",{staticClass:"text-left"},[t._v("Email")]),e("th",{staticClass:"text-left"},[t._v("Date")]),e("th",{staticClass:"text-left"},[t._v("Result")]),e("th")])]),e("tbody",t._l(t.newResults,(function(s){return 0===s.isLogged?e("tr",{key:s.id},[e("td",{staticClass:"text-left"},[t._v(t._s(s.name))]),e("td",{staticClass:"text-left"},[t._v(t._s(s.email))]),e("td",{staticClass:"text-left"},[t._v(t._s(s.date))]),e("td",{staticClass:"text-left"},[0===s.testWasNegative?e("q-badge",{attrs:{color:"red"}},[t._v("\n                    + "),e("q-icon",{staticClass:"q-ml-xs",attrs:{name:"fas fa-skull-crossbones",color:"white"}})],1):t._e(),1===s.testWasNegative?e("q-badge",{staticStyle:{width:"35px"},attrs:{color:"green"}},[t._v("\n                    - "),e("q-icon",{staticClass:"q-ml-sm",attrs:{name:"fas fa-smile",color:"white"}})],1):t._e()],1),e("td",{staticClass:"text-center"},[e("q-btn",{staticStyle:{width:"200px"},attrs:{outline:"",color:"orange",label:"log",dense:""},on:{click:function(e){return t.logResult(s.id)}}})],1)]):t._e()})),0)])],1)],1)]),e("q-tab-panel",{staticClass:"col column",attrs:{name:"archive"}},[e("q-input",{attrs:{dense:"",outline:"",color:"font",placeholder:"Search"},model:{value:t.search,callback:function(s){t.search=s},expression:"search"}}),e("div",{staticClass:"col q-mt-md"},[e("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[e("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[e("thead",{staticClass:"q-mb-md"},[e("tr",{staticClass:"bg-tertiary"},[e("th",{staticClass:"text-left"},[t._v("Name")]),e("th",{staticClass:"text-left"},[t._v("Email")]),e("th",{staticClass:"text-left"},[t._v("Date")]),e("th",{staticClass:"text-left"},[t._v("Result")])])]),e("tbody",t._l(t.visibleArchive,(function(s){return e("tr",{key:s.id},[e("td",{staticClass:"text-left"},[t._v(t._s(s.name))]),e("td",{staticClass:"text-left"},[t._v(t._s(s.email))]),e("td",{staticClass:"text-left"},[t._v(t._s(s.date))]),e("td",{staticClass:"text-left"},[0===s.testWasNegative?e("q-badge",{attrs:{color:"red"}},[t._v("\n                    + "),e("q-icon",{staticClass:"q-ml-xs",attrs:{name:"fas fa-skull-crossbones",color:"white"}})],1):t._e(),1===s.testWasNegative?e("q-badge",{staticStyle:{width:"35px"},attrs:{color:"green"}},[t._v("\n                    - "),e("q-icon",{staticClass:"q-ml-sm",attrs:{name:"fas fa-smile",color:"white"}})],1):t._e()],1)])})),0)])],1)],1)],1)],1)],1)},H=[],Q=(e("c880"),{name:"smt.covid.tests",props:{},data(){return{tab:"new",search:"",newResults:[],archivedResults:[]}},methods:{process(t){this.$q.loading.hide(),this.loading=!1,this.staff=t.staff,this.dates=t.dates},getNew(){this.$q.loading.show(),n["a"].getStaffTestsNew(this.processNew,this.$errorHandler)},processNew(t){this.$q.loading.hide(),this.newResults=t},getArchive(){this.$q.loading.show(),n["a"].getStaffTestsArchive(this.processArchive,this.$errorHandler)},processArchive(t){this.$q.loading.hide(),this.archivedResults=t},logResult(t){n["a"].putStaffTestsArchive(this.processLog,this.$errorHandler,t)},processLog(t){var s=this.newResults.find((function(s){return s.id===t.id}));s.isLogged=1}},computed:{visibleArchive(){var t=this;return""===this.search?this.archivedResults:this.archivedResults.filter((function(s){return s.name.toLowerCase().indexOf(t.search)>-1}))}},watch:{tab(t){"new"===t&&this.getNew(),"archive"===t&&this.getArchive()}},components:{Answer:c["a"]},created(){this.getNew()}}),N=Q,$=e("4776"),O=e("dd08"),D=e("1411"),T=e("1d98"),M=e("f987"),E=e("34ff"),L=e("2ef0"),R=Object(f["a"])(N,A,H,!1,null,"7bc53755",null),I=R.exports;C()(R,"components",{QTabs:$["a"],QTab:O["a"],QTabPanels:D["a"],QTabPanel:T["a"],QScrollArea:p["a"],QMarkupTable:v["a"],QBadge:M["a"],QIcon:E["a"],QBtn:L["a"],QInput:m["a"],QBtnToggle:h["a"]});var P=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticStyle:{"overflow-y":"scroll"}},[e("div",{staticClass:"row"},[e("q-input",{staticClass:"col",attrs:{dense:"",outline:"",color:"font",placeholder:"Search"},model:{value:t.search,callback:function(s){t.search=s},expression:"search"}})],1),e("div",{staticClass:"row fit"},[e("div",{staticClass:"col q-mt-md"},[e("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[t.loading?t._e():e("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[e("thead",{staticClass:"q-mb-md"},[e("tr",{staticClass:"bg-tertiary"},[e("th",{staticClass:"text-left",on:{click:function(s){return t.setSort("lastName")}}},[t._v("Name")]),e("th",{staticClass:"text-left",on:{click:function(s){return t.setSort("watchCount")}}},[t._v("Watched by #")]),e("th",{staticClass:"text-left"},[t._v("Watched By")])])]),e("tbody",t._l(t.sorted,(function(s){return e("tr",{key:s.id},[e("td",{staticClass:"text-left"},[t._v(t._s(s.firstname+" "+s.lastname)+"\n              ")]),e("td",{staticClass:"text-left"},[t._v(t._s(s.watchers.length)+" "),0===s.watchers.length?e("q-icon",{attrs:{name:"fad fa-exclamation-triangle",color:"warning"}}):t._e()],1),e("td",{staticClass:"text-left"},t._l(s.watchers,(function(s){return e("q-badge",{key:s.id,staticClass:"q-mx-xs text-black",attrs:{color:"accent"}},[t._v("\n                  "+t._s(s.fullName)+"\n                ")])})),1)])})),0)])],1)],1)])])},W=[],B={name:"smt.covid.staff.watchers",props:{},data(){return{staff:[],search:"",loading:!0,dates:[],sortKey:"lastname",sortDir:"asc"}},methods:{process(t){this.$q.loading.hide(),this.loading=!1,this.staff=t.staff,this.dates=t.dates},setSort(t){t===this.sortKey&&(this.sortDir="asc"===this.sortDir?"desc":"asc"),this.sortKey=t}},computed:{visible(){var t=this.search,s=this.staff;return""===t?s:s.filter((function(s){return s.firstname.toLowerCase().indexOf(t)>-1||s.lastname.toLowerCase().indexOf(t)>-1}))},sorted(){var t=this.visible.filter((function(t){return t.id>0}));return t.sort(this.$compare(this.sortKey,this.sortDir))}},components:{Answer:c["a"]},created(){this.$q.loading.show(),n["a"].getStaffWatchers(this.process,this.$errorHandler)}},K=B,j=Object(f["a"])(K,P,W,!1,null,"83e7cf24",null),Y=j.exports;C()(j,"components",{QInput:m["a"],QScrollArea:p["a"],QMarkupTable:v["a"],QIcon:E["a"],QBadge:M["a"]});var J=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("q-page",{},[e("div",{staticClass:"row fit q-gutter-xs",staticStyle:{"max-width":"300 px"}},[e("q-card",{staticClass:"col",attrs:{outline:""}},[e("q-card-section",{staticClass:"bg-tertiary"},[e("span",{staticClass:"text-bold q-mb-md"},[t._v("Pupils")]),e("br"),e("q-toggle",{staticClass:"font-secondary col q-mt-xl",attrs:{"false-value":0,"true-value":1,label:"System Active",color:"positive"},on:{input:t.setPupilStatus},model:{value:t.status.students.active,callback:function(s){t.$set(t.status.students,"active",s)},expression:"status.students.active"}}),e("q-btn",{staticClass:"text-positive col q-mt-xl full-width",attrs:{label:"Send Today's Email",outline:""},on:{click:function(s){t.confirmStudents=!0}}}),e("q-btn",{staticClass:"text-positive col q-mt-xl full-width",attrs:{label:"Send House Emails",outline:""},on:{click:function(s){t.confirmHouses=!0}}})],1)],1),e("q-card",{staticClass:"col",attrs:{outline:""}},[e("q-card-section",{staticClass:"bg-tertiary"},[e("span",{staticClass:"text-bold q-mb-md"},[t._v("Staff")]),e("br"),e("q-toggle",{staticClass:"font-secondary col q-mt-xl",attrs:{"false-value":0,"true-value":1,label:"System Active",color:"positive"},on:{input:t.setStaffStatus},model:{value:t.status.staff.active,callback:function(s){t.$set(t.status.staff,"active",s)},expression:"status.staff.active"}}),e("q-btn",{staticClass:"text-positive col q-mt-xl full-width",attrs:{label:"Send Today's Email",outline:""},on:{click:function(s){t.confirmStaff=!0}}}),e("q-btn",{staticClass:"text-positive col q-mt-xl full-width",attrs:{label:"Send HOD Emails",outline:""},on:{click:function(s){t.confirmHODS=!0}}})],1)],1)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.confirmStudents,callback:function(s){t.confirmStudents=s},expression:"confirmStudents"}},[e("q-card",{staticClass:"bd-font"},[e("q-card-section",{staticClass:"row items-center"},[e("span",{staticClass:"q-ml-sm"},[t._v("Are you sure about this?")])]),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-font",attrs:{outline:"",label:"Cancel",color:"font"}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-positive",attrs:{outline:"",label:"I am",color:"primary"},on:{click:t.sendStudents}})],1)],1)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.confirmStaff,callback:function(s){t.confirmStaff=s},expression:"confirmStaff"}},[e("q-card",{staticClass:"bd-font"},[e("q-card-section",{staticClass:"row items-center"},[e("span",{staticClass:"q-ml-sm"},[t._v("Are you sure about this?")])]),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-font",attrs:{outline:"",label:"Cancel",color:"font"}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-positive",attrs:{outline:"",label:"I am",color:"primary"},on:{click:t.sendStaff}})],1)],1)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.confirmHouses,callback:function(s){t.confirmHouses=s},expression:"confirmHouses"}},[e("q-card",{staticClass:"bd-font"},[e("q-card-section",{staticClass:"row items-center"},[e("span",{staticClass:"q-ml-sm"},[t._v("Houses. Are you sure about this?")])]),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-font",attrs:{outline:"",label:"Cancel",color:"font"}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-positive",attrs:{outline:"",label:"I am",color:"primary"},on:{click:t.sendHouses}})],1)],1)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.confirmHODS,callback:function(s){t.confirmHODS=s},expression:"confirmHODS"}},[e("q-card",{staticClass:"bd-font"},[e("q-card-section",{staticClass:"row items-center"},[e("span",{staticClass:"q-ml-sm"},[t._v("HODS. Are you sure about this?")])]),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-font",attrs:{outline:"",label:"Cancel",color:"font"}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-positive",attrs:{outline:"",label:"I am",color:"primary"},on:{click:t.sendHODS}})],1)],1)],1)],1)},U=[],z={name:"smt.covid.control",props:{},data(){return{status:{students:{active:0},staff:{active:0}},confirmStudents:!1,confirmStaff:!1,confirmHouses:!1,confirmHODS:!1}},methods:{sendStaff(){n["a"].postStaffEmails()},sendStudents(){n["a"].postStudentEmails()},sendHouses(){n["a"].postHouseEmails()},sendHODS(){n["a"].postHODEmails()},setPupilStatus(t,s){n["a"].putStudentsStatus(null,null,this.status.students)},setStaffStatus(t){n["a"].putStaffStatus(null,null,this.status.staff)},process(t){this.status=t}},computed:{},components:{},created(){n["a"].getStatus(this.process,this.$errorHandler)}},F=z,G=e("8c42"),V=e("ebe6"),X=e("965d"),Z=e("3d3c"),tt=e("e81c"),st=e("9f30"),et=e("5b32"),at=e("58c0"),lt=Object(f["a"])(F,J,U,!1,null,"3a6a2138",null),it=lt.exports;C()(lt,"components",{QPage:G["a"],QCard:V["a"],QCardSection:X["a"],QToggle:Z["a"],QBtn:L["a"],QDialog:tt["a"],QAvatar:st["a"],QCardActions:et["a"]}),C()(lt,"directives",{ClosePopup:at["a"]});var rt={name:"PageSMTWatch",data(){return{elements:[{name:"tests",label:"Tests",component:I},{name:"students",label:"Pupils Qs",component:q},{name:"staff",label:"Staff Qs",component:k},{name:"staff watchers",label:"Staff Watchers",component:Y},{name:"control",label:"Control Qs",component:it}]}},components:{toolbarPage:i["a"]}},ot=rt,nt=Object(f["a"])(ot,a,l,!1,null,null,null);s["default"]=nt.exports}}]);